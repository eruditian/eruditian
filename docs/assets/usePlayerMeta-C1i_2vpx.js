import{d as e,f as t}from"./index-D5TSYjKE.js";var n=[];for(let e=0;e<256;++e)n.push((e+256).toString(16).slice(1));function r(e,t=0){return(n[e[t+0]]+n[e[t+1]]+n[e[t+2]]+n[e[t+3]]+`-`+n[e[t+4]]+n[e[t+5]]+`-`+n[e[t+6]]+n[e[t+7]]+`-`+n[e[t+8]]+n[e[t+9]]+`-`+n[e[t+10]]+n[e[t+11]]+n[e[t+12]]+n[e[t+13]]+n[e[t+14]]+n[e[t+15]]).toLowerCase()}var i,a=new Uint8Array(16);function o(){if(!i){if(typeof crypto>`u`||!crypto.getRandomValues)throw Error(`crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported`);i=crypto.getRandomValues.bind(crypto)}return i(a)}var s={randomUUID:typeof crypto<`u`&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function c(e,t,n){e||={};let i=e.random??e.rng?.()??o();if(i.length<16)throw Error(`Random bytes length must be >= 16`);if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){if(n||=0,n<0||n+16>t.length)throw RangeError(`UUID byte range ${n}:${n+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[n+e]=i[e];return t}return r(i)}function l(e,t,n){return s.randomUUID&&!t&&!e?s.randomUUID():c(e,t,n)}var u=l,d=t(e()),f=[`pink`,`blue`,`green`,`cyan`,`yellow`,`purple`],p={version:3,players:{},active_players:[]},m=()=>{let e=window.localStorage.getItem(`players_meta`);return e&&JSON.parse(e).version===p.version?JSON.parse(e):p},h=(e={})=>({id:u(),name:`Unknown player`,color_preference:`green`,...e}),g=()=>{let[e,t]=(0,d.useState)(m()),[n,r]=(0,d.useState)(JSON.stringify(m()));(0,d.useEffect)(()=>{t(JSON.parse(n))},[n]);let i=(0,d.useCallback)(e=>{console.log(`players_meta`,e);let n=JSON.stringify(e);r(n),window.localStorage.setItem(`players_meta`,n),t(e);let i=new CustomEvent(`updatePlayersMeta`,{detail:n});window.dispatchEvent(i)},[]);(0,d.useEffect)(()=>{let e=e=>{r(e.detail)},t=()=>{let e=window.localStorage.getItem(`players_meta`);e&&JSON.parse(e).version===p.version&&r(e)};return window.addEventListener(`updatePlayersMeta`,e),window.addEventListener(`storage`,t),()=>{window.removeEventListener(`updatePlayersMeta`,e),window.removeEventListener(`storage`,t)}},[]);let a=(0,d.useCallback)(t=>{let n={...e},r=t?.id?n.players[t.id]:h(t);return n.players[r.id]={...r,...t},i(n),n.players[r.id]},[e,i]),o=(0,d.useCallback)(t=>{let n=e.players[t];if(!n)throw Error(`Player not found. `+t);return n},[e]),s=(0,d.useCallback)(t=>{let n=[...f],r=t.map(t=>{if(!e.players[t.id])throw Error(`Player not found. `+t.id);let r=n.findIndex(e=>e===t.color_preference);return r>-1&&n.splice(r,1),[{...t,color:t.color_preference},r>-1]}).map(([e,t])=>{if(t)return e;let r=n.splice(0,1)[0];return{...e,color:r}});i({...e,active_players:r})},[e,i]);return{players_meta:e,setPlayer:a,getPlayer:o,setActivePlayers:s,setPlayersMeta:i}};export{u as n,g as t};