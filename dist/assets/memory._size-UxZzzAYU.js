import{n as e,r as t,t as n}from"./middleware-B-nWziLx.js";import{a as r,d as i,f as a,i as o,l as s,t as c}from"./index-B5YRbJ1D.js";import{n as l,t as u}from"./usePlayerMeta-BehOLsAv.js";var d=a(i()),f=`/assets/memory_card_back-CVgvHl3n.png`,p=a(s()),m=({data:{state:e,image:t,player:n},onClick:i})=>{let a=n?.color;return(0,p.jsxs)(`div`,{className:r(`inset-shadow-accent border-accent relative h-full w-full cursor-pointer rounded-lg border inset-shadow-sm transition-all duration-700`,(e===`revealed`||e===`matched`)&&`cursor-default border-transparent inset-shadow-transparent`,e===`peeking`&&a===`green`&&`inset-shadow-green-500/80`,e===`peeking`&&a===`blue`&&`inset-shadow-blue-600/90`,e===`peeking`&&a===`pink`&&`inset-shadow-pink-400/90`,e===`peeking`&&a===`cyan`&&`inset-shadow-cyan-500/80`,e===`peeking`&&a===`yellow`&&`inset-shadow-yellow-400/80`,e===`peeking`&&a===`purple`&&`inset-shadow-purple-500/90`,e===`peeked`&&`inset-shadow-accent`),onClick:i,onContextMenu:e=>{e.stopPropagation(),e.preventDefault(),i()},children:[(0,p.jsx)(`div`,{style:{backgroundImage:`url(${f})`},className:r(`absolute inset-2 rounded-lg bg-black bg-contain bg-center bg-no-repeat`)}),(0,p.jsx)(`div`,{style:{backgroundImage:`url(${t})`},className:r(`absolute inset-2 rounded-lg bg-black bg-contain bg-center bg-no-repeat opacity-0 transition-all duration-700`,e!==`hidden`&&`opacity-100`,e===`revealed`&&`shadow-center`,a===`green`&&`shadow-green-500/90`,a===`blue`&&`shadow-blue-500/100`,a===`pink`&&`shadow-pink-300/100`,a===`cyan`&&`shadow-cyan-300/90`,a===`yellow`&&`shadow-yellow-400/90`,a===`purple`&&`shadow-purple-600/90`,e===`peeked`&&`opacity-0`)})]})};const h=e=>{let t=e.length;for(;t!=0;){let n=Math.floor(Math.random()*t);t--,[e[t],e[n]]=[e[n],e[t]]}return e};var g=`/assets/airplane-Bf3LrnqQ.jpg,/assets/apple_tree-Bb9WtVhB.jpg,/assets/bear_panda-GUBxK7li.jpg,/assets/bear_white-Bz3GRE4c.jpg,/assets/bus-qT0D2ZnS.jpg,/assets/car_blue-DK5BiqRD.jpg,/assets/car_green-B4PQOaHD.jpg,/assets/car_pink-Cbuv-s-Q.jpg,/assets/car_yellow-B0xfneIH.jpg,/assets/chipmunk_acorn-D96PQegw.jpg,/assets/chipmunk_in_dress-BqgTaOk-.jpg,/assets/crab-BI6WikjB.jpg,/assets/elephants_1-Ck9wiLuq.jpg,/assets/elephants_2-DjprvGwQ.jpg,/assets/fish_3-DJK7rgEC.jpg,/assets/fish_blue-CnzFUOR5.jpg,/assets/fish_shark-DuR2PObI.jpg,/assets/fish_yellow-C90g5B50.jpg,/assets/flower_blue-BQtqX5r1.jpg,/assets/flower_sun-BqUB_tQ1.jpg,/assets/fox-cB8YMq7J.jpg,/assets/goat-CtjtdCZC.jpg,/assets/hamster_eating-B7RWrxoc.jpg,/assets/lion-B-rh_RGG.jpg,/assets/manta_ray-CuJVJezL.jpg,/assets/moon-CJ_IS7UL.jpg,/assets/orca-C9ggmbRT.jpg,/assets/prince_blue-19CMmLTZ.jpg,/assets/prince_pink-Du-7VQUK.jpg,/assets/prince_yellow-DGtSQ4e0.jpg,/assets/princess_blue-Bp82K62V.jpg,/assets/princess_carousel-C4632Fcl.jpg,/assets/princess_purple-B1ekncUu.jpg,/assets/princess_snorklings-O65rXluZ.jpg,/assets/princess_surfing-tU4xBswj.jpg,/assets/princess_swinging-B50sSn9u.jpg,/assets/princess_water_dance-CHg9jc3M.jpg,/assets/princess_yellow-BFEuhQqO.jpg,/assets/pups_1-BHMIGAN1.jpg,/assets/pups_2-omDBhMd_.jpg,/assets/pups_3-DZYknMLr.jpg,/assets/pups_4-C3p6Stt8.jpg,/assets/pups_5-CYgnXYiQ.jpg,/assets/rainbow-AupY7N-x.jpg,/assets/seagull-CwxTuadh.jpg,/assets/starfish-BpPXRYkY.jpg,/assets/sun-mf9DYvev.jpg,/assets/tree_palm-DDUvjXBb.jpg,/assets/tea_pot-C1d0u3sU.jpg,/assets/tree_house-DB4aJuXY.jpg,/assets/unicorn_pink-D_U9JcZF.jpg,/assets/unicorn_white-DK309iW_.jpg,/assets/waterfall-CCBSagLN.jpg`.split(`,`),_=(e,t)=>{let n=h([...g]),r=Array(e/t).fill(null).reduce((e,r,i)=>{let a=Array(t).fill(null).map(()=>l());return a.forEach(t=>{e[t]={id:t,image:n[i],siblings:a,state:`hidden`,index:0}}),e},{}),i=h(Object.values(r)).map((e,t)=>(e.index=t,e));return{cells:r,grid:i}},v=e()(n((e,t)=>({cells:{},grid:[],completed:!1,match_count:2,scores:{},current_player:0,player_count:1,players:[],init:(n,r,i=2)=>{let a=_(n,i),o=r.reduce((e,t)=>(e[t.id]={clicks:0,score:0},e),{});e({...a,match_count:i,scores:o,completed:!1,players:r,current_player:0}),requestAnimationFrame(t().tick)},backgroundClick:()=>{},cellClick:n=>{let{cells:r,grid:i,match_count:a,scores:o,current_player:s,players:c}=t(),l=r[n];if(l.state!==`hidden`)return;let u=i.filter(e=>e.state===`peeking`&&!e.pending),d=u.every(e=>e.image===l.image);u.push(l);let f=d&&u.length===a,p=u.map(e=>{if(f){let t={...e,player:c[s],state:`revealed`};return delete t.pending,t}if(!d)return{...e,player:c[s],state:`peeking`,pending:{data:`peeked`,timeout:performance.now()+1500}};let t={...e,player:c[s],state:`peeking`};return delete t.pending,t}),m=[...i],h={...r};p.forEach(e=>{m[e.index]=e,h[e.id]=e});let g=m.every(e=>e.state===`revealed`),_=c[s].id,v={...o,[_]:{clicks:o[_].clicks+1,score:f?o[_].score+1:o[_].score}};e({grid:m,cells:h,completed:g,scores:v,current_player:d?s:(s+1)%c.length})},tick:()=>{let{grid:n,cells:r,completed:i}=t(),a=n.filter(e=>e.pending);if(a.length===0){i||requestAnimationFrame(t().tick);return}let o=a.filter(e=>performance.now()>(e.pending?.timeout||0)).map(e=>{let t=e.pending?.data||`hidden`,n={...e,state:t};return delete n.pending,t===`peeked`&&(delete n.player,n.pending={timeout:performance.now()+500,data:`hidden`}),n});if(o.length>0){let t=[...n],i={...r};o.forEach(e=>{t[e.index]=e,i[e.id]=e}),e({grid:t,cells:i})}requestAnimationFrame(t().tick)}}),{name:`Eruditio Memory State`})),y=({player:e,score:t,current_player:n})=>{let i=e.color,a=n===e.id;return(0,p.jsxs)(`div`,{className:r(`shadow-center-xs rounded px-2 py-1 text-2xl opacity-80 transition-shadow duration-300`,a&&`shadow-center font-bold opacity-100`,i===`green`&&`shadow-green-500/100`,i===`blue`&&`shadow-blue-500/100`,i===`pink`&&`shadow-pink-400/100`,i===`cyan`&&`shadow-cyan-300/90`,i===`yellow`&&`shadow-yellow-400/90`,i===`purple`&&`shadow-purple-600/90`),children:[e.name,(0,p.jsx)(`span`,{className:`ml-2 font-light`,children:t})]})},b=e=>Symbol.iterator in e,x=e=>`entries`in e,S=(e,t)=>{let n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(let[e,t]of n)if(!r.has(e)||!Object.is(t,r.get(e)))return!1;return!0},C=(e,t)=>{let n=e[Symbol.iterator](),r=t[Symbol.iterator](),i=n.next(),a=r.next();for(;!i.done&&!a.done;){if(!Object.is(i.value,a.value))return!1;i=n.next(),a=r.next()}return!!i.done&&!!a.done};function w(e,t){return Object.is(e,t)?!0:typeof e!=`object`||!e||typeof t!=`object`||!t||Object.getPrototypeOf(e)!==Object.getPrototypeOf(t)?!1:b(e)&&b(t)?x(e)&&x(t)?S(e,t):C(e,t):S({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)})}function T(e){let t=d.useRef(void 0);return n=>{let r=e(n);return w(t.current,r)?t.current:t.current=r}}var E=({count:e})=>{let{players_meta:n}=u(),i=v(({init:e})=>e),a=v(({cellClick:e})=>e),s=v(({grid:e})=>e),c=v(({completed:e})=>e),l=v(({players:e})=>e),f=v(T(({current_player:e,players:t})=>t.length>0?t[e]:void 0)),h=v(({scores:e})=>e);return(0,d.useEffect)(()=>{i(e,n.active_players)},[i,e,n]),(0,p.jsxs)(`div`,{className:r(`inset-shadow-center-lg relative flex h-full flex-col gap-2 inset-shadow-green-500/100 transition-shadow duration-300`,f?.color===`green`&&`inset-shadow-green-500/80`,f?.color===`blue`&&`inset-shadow-blue-600/90`,f?.color===`pink`&&`inset-shadow-pink-400/90`,f?.color===`cyan`&&`inset-shadow-cyan-500/80`,f?.color===`yellow`&&`inset-shadow-yellow-400/80`,f?.color===`purple`&&`inset-shadow-purple-500/90`),children:[(0,p.jsxs)(`div`,{className:`flex items-center gap-4 pt-4`,children:[(0,p.jsx)(`p`,{className:`text-accent-foreground/70 ml-5 text-2xl font-bold`,children:`Memory`}),(0,p.jsx)(`div`,{className:`flex gap-3`,children:l.map(e=>(0,p.jsx)(y,{player:e,score:h[e.id]?.score||0,current_player:f?f.id:``},e.id))})]}),(0,p.jsx)(`div`,{className:r(`grid grow grid-cols-4 gap-6 px-8 pt-2 pb-16`),children:s.map(e=>(0,p.jsx)(m,{data:e,onClick:()=>a(e.id)},e.id))}),c&&(0,p.jsx)(`div`,{className:`absolute top-1/2 left-1/2 w-0`,onClick:()=>i(e,n.active_players),children:(0,p.jsxs)(`div`,{className:`bg-background/80 border-accent-foreground/70 relative flex w-80 -translate-1/2 flex-col items-center gap-2 rounded-md border p-4`,children:[`Play again`,(0,p.jsx)(o,{variant:`secondary`,size:`icon`,children:(0,p.jsx)(t,{})})]})})]})},D=[8,12,16,18,20,24,28],O=e=>{let t=parseInt(e,10);return D.includes(t)?t:12};function k(){let{size:e}=c.useParams();return(0,p.jsx)(E,{count:O(e)})}export{k as component};